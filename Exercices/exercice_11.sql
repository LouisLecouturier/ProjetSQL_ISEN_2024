-- Exercice 11 - List of all flight that have been done a weekend (Saturday or Sunday)

INSERT INTO aircrafts(aircraft_nbr, last_servicing, totalflighthours, koaircraft_iata)
VALUES 
(1, '01/01/2024', 5000, 'A320'),
(2, '01/02/2024', 5100, 'B737'),
(3, '01/03/2024', 5200, 'A380'),
(4, '01/04/2024', 5300, 'B747'),
(5, '01/05/2024', 5400, 'A320'),
(6, '01/06/2024', 5500, 'B737'),
(7, '01/07/2024', 5600, 'A380'),
(8, '01/08/2024', 5700, 'B747'),
(9, '01/09/2024', 5800, 'A320'),
(10, '01/10/2024', 5900, 'B737'),
(11, '01/11/2024', 6000, 'A380'),
(12, '01/12/2024', 6100, 'B747');

INSERT INTO EFF_FLIGHTS (WEEKDAYS_DAY_NBR, PLAN_FLIGHTS_FLIGHT_NBR, PLAN_DEP_DATE, RES_SEATS_QTY, OCC_SEATS_QTY, REAL_DEP_TIME, REAL_ARR_TIME, LOADED_FUEL, CREWS_CREW_CODE, AIRCRAFTS_AIRCRAFT_NBR)
VALUES
  (1, 1, '2024-03-25 10:00:00', 180, 170, '2024-03-25 10:15:00', '2024-03-25 11:30:00', 25000, 1, 1),
  (2, 2, '2024-03-26 15:00:00', 160, 145, '2024-03-26 15:10:00', '2024-03-26 16:45:00', 20000, 1, 2),
  (3, 1, '2024-03-27 08:00:00', 290, 280, '2024-03-27 08:15:00', '2024-03-27 12:15:00', 45000, 2, 3),
  (4, 4, '2024-03-28 12:00:00', 360, 340, '2024-03-28 12:15:00', '2024-03-28 15:30:00', 50000, 3, 4),
  (5, 2, '2024-03-29 10:00:00', 180, 170, '2024-03-29 10:15:00', '2024-03-29 11:30:00', 25000, 1, 1),
  (6, 1, '2024-03-30 10:00:00', 140, 130, '2024-03-30 10:15:00', '2024-03-30 11:00:00', 20000, 1, 1),
  (6, 2, '2024-03-30 13:00:00', 120, 110, '2024-03-30 13:15:00', '2024-03-30 15:00:00', 18000, 2, 2);

SELECT ef.*
FROM EFF_FLIGHTS ef
INNER JOIN PLAN_DAYFLIGHTS pd ON ef.WEEKDAYS_DAY_NBR = pd.WEEKDAYS_DAY_NBR
                              AND ef.PLAN_FLIGHTS_FLIGHT_NBR = pd.PLAN_FLIGHTS_FLIGHT_NBR
WHERE pd.WEEKDAYS_DAY_NBR IN (6, 7);